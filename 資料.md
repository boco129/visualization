# データ分析での可視化におけるグラフ/チャート選択について



## 本ドキュメント、関連スクリプトの目的

- データ分析での適切なグラフ/チャート選択は仮説の探索、検証時だけでなくユーザーへ理解しやすい形で説明する際など分析の多くの場面で役立つ重要なもの
- 重要である一方、分析におけるグラフ/チャート選択は現在個人の知識や経験に依存。初学者向けのノウハウとなるものがあまり部内で共有されていない状況
- 本ドキュメント、関連スクリプトは自身の知識の整理を兼ねてデータ分析の初学者向けにグラフ/チャート選択の勘所の参考資料として整備するもの


## データ分析における可視化の概要

### 可視化とは

データ可視化は、データをグラフィカルな形式に変換するプロセスであり、情報を視覚的に表現する方法。これにより、データの背後にある傾向やパターンを簡単に把握し、データを効果的に解釈できる。

### 可視化の目的

1. **データの理解**: 可視化は、データを直感的に理解するのに役立つ。複雑なデータセットも、視覚的な表現を通じて簡単に把握できるようになる。

2. **パターンやトレンドの特定**: 可視化は、データ内のパターンやトレンドを発見する手助けとなる。これにより、意思決定や戦略策定に役立つ洞察が得られる可能性がある。

3. **異常値の検出**: データセット内の異常値や外れ値を視覚的に特定することができる。これにより、データのクリーニングや前処理が容易になり、分析の精度を向上させることができる。

4. **結果の伝達**: 可視化は、分析結果を他者に伝える際に効果的な手段。視覚的な表現は、データを明確かつ分かりやすく伝えることができ、意思決定者や関係者が迅速に理解し、行動を取ることができる。

### 適切なグラフ/チャート選択が果たす役割

分析したいデータに応じ、適切なグラフ/チャートを選択することはデータ分析において以下のような利点がある。
- データを正確に表現し、誤解や誤った解釈を防ぐことができる
- 情報を分かりやすく伝えることができる
- データから得られる洞察を迅速かつ容易に抽出でき、効率的に分析を進めることができる

適切なグラフやチャートを選択する際には、データの種類（カテゴリカル、連続、時系列など）、分析の目的（比較、関係性、分布、構成など）、および視覚的な要素（色、形、サイズなど）を考慮することが重要。
今回このドキュメントにおいては適切なチャート選択の参考になる考え方を示す。


### 適切なチャート選択

グラフやチャートによって得意とする表現は異なり，扱えるデータの型も異なる。
したがってデータと目的によって利用するグラフをある程度絞ることができる。
例えばグラフをつくる前に読む本では以下のように整理されており，またWeb上でも多くのチートシートが公開されている

| 得意な表現方法 | 個別 | 全体||
|------------------------|-----------|-------------|--------------------------|
|||実数| 割合 |
| データ項目の比較       | 棒グラフ  | レーダーチャート | 円グラフ |
|      |  |積み上げ棒グラフ||
| 時間の経過による推移   | 折れ線グラフ | 面グラフ     |  | 
| データの偏り| ヒートマップ|| |
| データ項目同士の関係   | 散布図    |             |   

ここではFlow Chart Shows You What Chart to Useにおいて示されている以下の4つの分類に従って分類していく。

#### 分布

具体的な実装や表現については以下のスクリプトを参照。

|変数の数|データ数|推奨されるグラフ|特徴|注意点|
|:---|:---|:---|:---|:---|
|1変数|データ数を考慮不要|ヒストグラム| データの分布を視覚化するのに適している。| ・binの区切りかたによって印象が変わる|
|||密度プロット| ・単変量の分布を表現できる| ・バンド幅を変更することで印象が変わる|
|2変数|データ数が少ない場合|ヒストグラム| ・2つの変数の分布を視覚化するのに適している。| ・一つのグラフに複数のヒストグラムをプロットすると理解しづらくなる<br>・複数確認する際はサブプロットの使用を推奨|
|||箱ひげ図|・中央値、四分位数、外れ値を把握できる。<br>複数の変数を扱うことができる| ・分布はわからないためバイオリンプロットなどの使用も検討する<br>・中央値順に並べるとインサイトを生みやすい<br>・サンプル数がわからなくなってしまうので、プロットに示しておくのが親切|
|||散布図| ・2つの変数の分布を把握できる。|・データ数があまりにも多いとよくわからないことになる |
||データ数が多い場合|バイオリンプロット| 2つの変数の分布を視覚化するのに適している。| ・グループごとにサンプルが異なる場合は、サンプル数をプロットすると良い。<br>・中央値順に並べるとインサイトを生みやすい|
|||密度プロット|・分布の形状を視覚化するのに適している。| 一つのグラフに複数の密度プロットをすると理解しづらくなる<br>・複数確認する際はサブプロットの使用を推奨|
|3変数|データ数を考慮不要|箱ひげ図| ・3つの変数の中央値、四分位数、外れ値を把握できる。| ・分布はわからないためバイオリンプロットなどの使用も検討する<br>・中央値順に並べるとインサイトを生みやすい<br>・サンプル数がわからなくなってしまうので、プロットに示しておくのが親切|
|||バイオリンプロット| ・3つの変数の分布の形状を視覚化するのに適している。| ・グループごとにサンプルが異なる場合は、サンプル数をプロットすると良い。<br>・中央値順に並べるとインサイトを生みやすい|
||データ数が多い場合|3Dプロット| ・3つの変数の関係性を視覚化するのに適している。| |
|4変数以上|データ数を考慮不要|箱ひげ図| ・中央値、四分位数、外れ値を把握できる。| ・分布はわからないためバイオリンプロットなどの使用も検討する<br>・中央値順に並べるとインサイトを生みやすい<br>・サンプル数がわからなくなってしまうので、プロットに示しておくのが親切。|
|||バイオリンプロット| ・ 分布の形状を視覚化するのに適している。|・グループごとにサンプルが異なる場合は、サンプル数をプロットすると良い。<br>・中央値順に並べるとインサイトを生みやすい |


#### 構成

具体的な実装や表現については以下のスクリプトを参照。

| データタイプ | ピリオド数 | 利用場面 | 推奨されるグラフ | 特徴 | 注意点 |
|:--- |:--- |:--- |:--- |:--- |:--- |
| 時系列でないデータ | ピリオド数なし | シンプルな全体におけるシェアを表現 | 円グラフ |シンプルな全体におけるシェアを表現できる|  |
|  |  | 累積、もしくは加減算を表現 | ウォーターフォールチャート |累積、もしくは加減算の流れを表現できる |  |
|  |  | ある構成要素の中の構成割合を表現 | 100%積み上げ棒グラフ | カテゴリーごとの構成割合の相対的な変化を表現することができる |  |
|  |  | 構成比を表現 | ツリーマップ |構成割合を表現できる |  |
| 時系列データ | ピリオド数少 | 相対的な構成割合の変化を表現 | 100%積み上げ棒グラフ | 相対的な構成割合の変化を表現できる|  |
|  |  | 相対的な割合だけでなく絶対量による違いを表現 | 積み上げ棒グラフ | 相対的な割合だけでなく絶対量による違いを表現できる|  |
|  | ピリオド数多 | 相対的な構成割合の変化を表現 | 100%累積面グラフ | 相対的な構成割合の変化を表現できる|  |
|  |  | 相対的な割合だけでなく絶対量による違いを表現 | 累積面グラフ |相対的な割合だけでなく絶対量による違いを表現できる |  |

### 比較

具体的な実装や表現については以下のスクリプトを参照。

| データタイプ | ピリオド数 | 利用場面 | 推奨されるグラフ | 特徴 | 注意点 |
| --- | --- | --- | --- | --- | --- |
| 期間での比較 | ピリオド数大 | 周期性データ | 円形エリアチャート | ピリオドが多いと直感的に理解しやすい | | 
|  |  | 非周期データ | 折れ線グラフ | ピリオドが多いと直感的に理解しやすい |  |
|  | ピリオド数少 | カテゴリー数多 | 棒グラフ | カテゴリーごとの比較がしやすい |  |
|  | | カテゴリー数少 | 折れ線グラフ | 推移の流れを確認しやすい |  |
| 要素間の比較 | ピリオド数なし | アイテム間の2変数での比較 | 変数幅チャート | 複数の要素の差異を比較しやすい|  |
|  |  | 1変数でカテゴリー数多 | pairplot | 多カテゴリー間の関係性を一度に可視化可能 |  |
|  |  | 1変数でカテゴリー数少 | 棒グラフ縦、横 | 簡単に比較できる|  |

### 相関

具体的な実装や表現については以下のスクリプトを参照。


| 変数数 | データ数 | 推奨されるグラフ | 特徴 | 注意点 |
| --- | --- | --- | --- | --- |
| 2変数 | データ数少 | 散布図 | 2変数間の関係がわかる|データ数があまりにも多いとよくわからないことになる |
| 2変数 | データ数多 | 補助線付散布図 | 2変数間の分布と傾向がわかる| |
| 3変数 | データ数考慮不要 | バブルプロット | ・散布図同様に2変数間の関係を扱える| ・各バブルの大きさがどのぐらいの大きさか示す<br>・要素が多い場合には別にプロットする |
| 4変数〜 |  | ヒートマップ |・項目ごとに数の大小関係がわかる |・大抵の場合、正規化する必要あり|


